---
layout: default
title: Logs 2020 Apr
---

## 2020-04-04

### Speedup rubygem plugin system
https://github.com/rubygems/rubygems/pull/3108/files

### ruby misc
- `exists?`
deprecated

- keyword argument vs positional arguments \
> I would use positional arguments if I could easily guess their meanings based on the method’s name, but I find this rarely to be the case.

- lazy select
```ruby
class Enumerator 
  def lazy_select(&blk)
    self.class.new do |yielder| 
      each do |n| 
        yielder << n if blk[n]
      end 
    end 
  end 
end

enum.lazy_select {|n| n % 20 == 0}.first 5 # [0, 20, 40, 60, 80]
```

- fiber local var:
`ids = (Thread.current[InspectKey] ||= [])`

### New things you can use in 2.3.0
- Safe navigation &. \
Would make a && a.prop || default ot a.prop || default

- Frozen string literal \
Add # frozen_string_literal: true at start of the file

- Array#dig and Hash#dig

- Hash “comparison”

- Hash#to_proc \
use the & operator to create a proc and pass it to an Enumerable block.

- Hash fetch_values \
The difference is that #values_at returns nil when the key doesn’t exist, while #fetch_values raises a KeyError for keys that aren’t present.

- Enumerable#grep_v

- Numeric#positive?


### QuicKey – The quick tab switcher

### monospace font Iosevka

font-family: iosevka, Menlo, Monaco, 'Courier New', monospace

install: `brew tap homebrew/cask-fonts && brew cask install font-iosevka && brew cask install font-iosevka-slab`

### mac os key speed and delay until repeat

System Preferences -> Keyboard -> Key Repeat Rate
 
System Preferences -> Keyboard -> Delay Until Repeat

### zsh multios
```sh
# ZSH with MULTIOS option on
$ echo "hello there" >&1 | sed "s/hello/hi/"
hi there
hi there
$ echo "hello there" >&2 | sed "s/hello/hi/"
hello there
hi there
```

### git reflog
use it find hash, and recover `git reset --hard 78e1949`

`git config --global alias.gtree "log --graph --decorate --pretty=oneline --abbrev-commit --all"`

### mac hardware disconnect
https://support.apple.com/guide/security/hardware-microphone-disconnect-mac-ipad-secbbd20b00b/1/web/1

### bash set
https://www.gnu.org/software/bash/manual/html_node/The-Set-Builtin.html#The-Set-Builtin

### diff btw `__callee__` and `__method__`
Using the __callee__ helper, we can get the name of the current method exactly as it was called. For normal methods, this returns the same name as __method__. Once we use methods aliases however, the returned value differs since __callee__ always returns the name of the method as we actually called it, whichever alias that might be

## 07

### 血疫
正因为生命的基本 building block 的高度一致性，我们才能够通过吃掉并消化自然界的其他生物来获得所需的营养和能源，整个生物、生态圈才能成为一个完整的循环共生。
end

### ruby tricks
```ruby
first, *rest = args

def touch_down
  yield [3, 7]
  puts "touchdown!"
end

touch_down do |(first_down, second_down)| xxx end

# fetch and default in block
items.fetch(:bananas) { |key| "We don't carry #{key}!"}

"".present?
```

### git force push

use --force-with-lease
**a nuance** is when used with git fetch: https://blog.developer.atlassian.com/force-with-lease/

```sh
# ~/.gitconfig
[alias]
  deploy = "!git push --force deis \"$(git rev-parse --abbrev-ref HEAD):master\""
```

if by accident overwrite other's change, if someone is watching the repo, 

1. find the hash before the force push
2. Compose a URL https://github.com/org/repo/tree/deadbeef, where deadbeef is a hash of the last good commit to the damaged branch;
3. Open the branches/tags switcher in the GitHub’s web UI
4. Create a name for a new temporary branch (e.g., master-before-force-push);
5. Click “Create branch”.
